boot-2.1.3(spring 5.1.5) 기준으로 작성하였다.
스프링에서 핸들러가 초기화 되는 과정을 살펴본다.   
스프링에서 기본적으로 설정 되어있는 ```RequestMappingHandlerMapping``` 빈을 생성하고 초기화(```InitializingBean```) 하는 시점에 일어난다.
![타입에따른구현체](https://t1.daumcdn.net/cfile/tistory/99EB2A505E7A11E432)

### 핸들러 초기화 순서
1. RequestMappingHandlerMapping 빈 생성
2. 빈 초기화 하면서, initHandlerMethods 호출
3. 빈 팩토리에 등록되어 있는 빈들 중 ```@Controller``` 또는 ```@RequestMapping``` 를 가지고 있는 빈을 가져온다.
4. 핸들러가 될 수 있는 모든 메서드를 추출한다.(detectHandlerMethods)
5. 추출된 메서드를 registry 에 등록한다.(registerHandlerMethod)  

 
### getMappingForMethod
컨트롤러와 핸들러의 리퀘스트매핑 정보를 만드는 함수.
method(handler) 에서 RequestMapping annotation 의 정보를 기반으로 RequestMappingInfo 를 만든다.
handlerType(Controller) 에도 정보가 있다면 동일하게 만들고, 두 정보를 합친다.
, 
```java
protected RequestMappingInfo getMappingForMethod(Method method, Class<?> handlerType) {
    RequestMappingInfo info = createRequestMappingInfo(method);
    if (info != null) {
        RequestMappingInfo typeInfo = createRequestMappingInfo(handlerType);
        if (typeInfo != null) {
            info = typeInfo.combine(info);
        }
        String prefix = getPathPrefix(handlerType);
        if (prefix != null) {
            info = RequestMappingInfo.paths(prefix).build().combine(info);
        }
    }
    return info;
}
```

```java
protected void registerHandlerMethod(Object handler, Method method, T mapping) {
    this.mappingRegistry.register(mapping, handler, method);
}
```
```java
class MappingRegistry {

		private final Map<T, MappingRegistration<T>> registry = new HashMap<>();

		private final Map<T, HandlerMethod> mappingLookup = new LinkedHashMap<>();

		private final MultiValueMap<String, T> urlLookup = new LinkedMultiValueMap<>();

		private final Map<String, List<HandlerMethod>> nameLookup = new ConcurrentHashMap<>();

		private final Map<HandlerMethod, CorsConfiguration> corsLookup = new ConcurrentHashMap<>();

		private final ReentrantReadWriteLock readWriteLock = new ReentrantReadWriteLock();
// ...
}
```


(1) ```RequestMappingHandlerMapping requestMappingHandlerMapping()```
![prepareRefresh](https://t1.daumcdn.net/cfile/tistory/9963F4365E81FC0A14)
